***

# ğŸ“ Documentation de lâ€™arborescence du projet

## ğŸ”¹ Racine du projet
Ce projet est structurÃ© en deux parties principales :
- **backend/** â†’ Code serveur Node.js + API
- **frontend/** â†’ Interface utilisateur React/TypeScript

Des scripts `.sh` et `.bat` sont prÃ©sents pour dÃ©marrer/arrÃªter les serveurs.

***

## 1. **backend/**  
Contient le code cÃ´tÃ© serveur (API REST + GraphQL), ainsi que la configuration.

### Fichiers principaux :
- **.env / .env.dev / .env.prod** â†’ Variables dâ€™environnement (ports, clÃ©s, URL DBâ€¦).
- **server.js** â†’ Point dâ€™entrÃ©e du serveur Node.js (lancement Express, middlewares, routes).

### ğŸ“‚ `/middleware`
- **errorHandler.js** â†’ Middleware Express pour capter et formater les erreurs.
- **notFoundHandler.js** â†’ Middleware pour gÃ©rer les routes non trouvÃ©es (404).

### ğŸ“‚ `/routes`
- **anchor.js** â†’ Endpoints REST pour la gestion des â€œancragesâ€ (sauvegarde de traces, etc.).
- **graphql.js** â†’ DÃ©finition du serveur GraphQL (schÃ©mas + rÃ©solveurs).
- **graphql.js.bak** â†’ Copie du fichier GraphQL (backup).
- **history.js** â†’ Endpoints REST pour rÃ©cupÃ©rer lâ€™historique des vols.
- **index.js** â†’ Point central dâ€™enregistrement des routes dans Express.

### ğŸ“‚ `/services`
- **anchorService.js** â†’ Logique mÃ©tier liÃ©e aux ancrages (valider, sauvegarder, exporterâ€¦).
- **flightService.js** â†’ Logique mÃ©tier pour rÃ©cupÃ©rer, filtrer et formater les donnÃ©es de vol.

### ğŸ“‚ `/utils`
- **logger.js** â†’ Utilitaire centralisÃ© de logs (console + fichiers Ã©ventuellement).

***

## 2. **frontend/**  
Contient lâ€™application React (TypeScript), dÃ©coupÃ©e en composants, hooks, services et utilitaires.

### Fichiers racine :
- **package.json / package-lock.json** â†’ DÃ©pendances et scripts (build/startâ€¦).
- **index.html** â†’ Gabarit HTML oÃ¹ lâ€™app React est injectÃ©e.
- **tsconfig.json** â†’ Configuration du compilateur TypeScript.

### **src/**
Code source principal React.

***

### ğŸ“‚ `/src/components`
UI rÃ©utilisable + layout principal.

#### ğŸ“‚ `/src/components/common`
- **FlightMap.tsx** â†’ Composant carte Leaflet affichant la trace du vol + marqueurs, avec fonction `FlyToPosition`.
- **FlyToPosition.tsx** â†’ Variante isolÃ©e du centrage animÃ© de Leaflet.
- **FlightMap.css** â†’ Styles spÃ©cifiques de la carte et Ã©lÃ©ments Leaflet.
- **Pagination.tsx / Pagination.css** â†’ Composant paginÃ© gÃ©nÃ©rique.

#### ğŸ“‚ `/src/components/flights`
- **DetailsPanel.tsx** â†’ Panneau dâ€™informations dÃ©taillÃ©es sur un vol (champs dynamiques).
- **DetailsPanel.css** â†’ Styles du panneau.
- **DetectionsTable.tsx** â†’ Tableau listant vols/live ou historiques.
- **DetectionsTable.css** â†’ Styles du tableau.

#### ğŸ“‚ `/src/components/layout`
- **Header.tsx / Header.css** â†’ Bandeau supÃ©rieur avec titre, logo, etc.
- **MapLayout.tsx / MapLayout.css** â†’ Composant contenant la carte (`FlightMap`) et le panneau de dÃ©tails.
- **TablesLayout.tsx / TablesLayout.css** â†’ Composant affichant les tables de vols/live/historiques.
- **Sidebar.tsx / Sidebar.css** â†’ Composant menu latÃ©ral (options, filtresâ€¦).
- **AnchorModalLayout.tsx / .css** â†’ FenÃªtre modale pour valider ou annuler lâ€™ancrage dâ€™un vol.

***

### ğŸ“‚ `/src/hooks`
Hooks personnalisÃ©s pour factoriser lâ€™accÃ¨s aux donnÃ©es :
- **useDrones.ts** â†’ RÃ©cupÃ¨re la liste des drones connectÃ©s (live).
- **useAnchored.ts** â†’ RÃ©cupÃ¨re les vols dÃ©jÃ  ancrÃ©s.
- **useLocalHistory.ts** â†’ GÃ¨re lâ€™historique local stockÃ© dans le navigateur.
- **useRemoteEvents.ts** â†’ RÃ©cupÃ¨re lâ€™historique via API distante.
- **useAnchorModal.ts** â†’ Logique dâ€™ouverture/fermeture de la modale dâ€™ancrage.
- **useLiveTraces.ts** â†’ Suit les traces de position en direct des drones.

***

### ğŸ“‚ `/src/services`
Appels API et transformations :
- **api.ts** â†’ Contient les requÃªtes fetch/GraphQL/REST.
- **anchorService.ts** â†’ MÃ©thodes mÃ©tier pour formater et envoyer un â€œancrageâ€ Ã  lâ€™API.
- **historyService.ts** â†’ RÃ©cupÃ¨re lâ€™historique via lâ€™API REST.
- **apiInfos.txt / servicesInfos.txt** â†’ Notes/donnÃ©es de rÃ©fÃ©rence.

***

### ğŸ“‚ `/src/utils`
Utilitaires globaux :
- **constants.ts** â†’ Valeurs constantes utilisÃ©es partout (URLs, zoom carteâ€¦).
- **coords.ts** â†’ Fonctions de manipulation des coordonnÃ©es GPS (`getFlightTrace`, `isLatLng`, â€¦).
- **icons.ts** â†’ DÃ©finit les icÃ´nes Leaflet pour les drones/marqueurs.
- **format.ts** â†’ Fonctions de formatage de dates, chaÃ®nesâ€¦
- **graphql.ts** â†’ Utilitaire pour effectuer des requÃªtes GraphQL.
- **displayConfig.ts / fieldConfig.ts** â†’ Configurations dâ€™affichage des champs.
- **UtilsInfos.txt** â†’ Notes internes.

***

### ğŸ“‚ `/src/types`
- **models.ts** â†’ DÃ©finition des types/Interfaces TS (Flight, LatLng, Eventâ€¦).

***

### ğŸ“‚ `/src/assests`
(Ressources visuelles du projet si prÃ©sentes â€“ logos, imagesâ€¦).

***

## 3. **Scripts racine**
- **start-servers.sh / .bat** â†’ Script pour dÃ©marrer le backend et le frontend ensemble.
- **stop-servers.sh / .bat** â†’ Script pour arrÃªter le backend et le frontend.

***

## 4. **Fonctionnement global**
1. **Backend** se lance (Express + API REST + GraphQL).
2. **Frontend** se connecte Ã  lâ€™API/GraphQL pour rÃ©cupÃ©rer :
   - Vols live (`useDrones` + `useLiveTraces`)
   - Historique (`useRemoteEvents`)
   - Vols ancrÃ©s (`useAnchored`)
3. Lâ€™utilisateur sÃ©lectionne un vol dans **TablesLayout** :
   - `App.tsx` met Ã  jour `selected` et incrÃ©mente `flyToTrigger`.
   - `MapLayout.tsx` calcule `points`, `startPosition`, `livePosition`.
   - `FlightMap.tsx` recentre **uniquement quand `flyToTrigger` change**.
4. Lâ€™utilisateur peut ancrer un vol via **AnchorModalLayout**.
5. Les styles sont gÃ©rÃ©s dans les CSS correspondants.

***
